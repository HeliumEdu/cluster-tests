test_name: Test example schedule is populated

strict: False

marks:
  - usefixtures:
      - access_token

stages:
  - name: List course groups
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/coursegroups/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      verify_response_with:
        function: src.utils.common:assert_response_length
        extra_kwargs:
          expected_length: 1
      save:
        json:
          course_group_id: "[0].id"

  - name: List courses
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/coursegroups/{course_group_id}/courses/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      verify_response_with:
        function: src.utils.common:assert_response_length
        extra_kwargs:
          expected_length: 3

  - name: List courses with title filter
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/coursegroups/{course_group_id}/courses/?title=Intro%20to%20Psychology%20%F0%9F%A7%A0"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      save:
        json:
          course_id: "[0].id"

  - name: List categories
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/coursegroups/{course_group_id}/courses/{course_id}/categories/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      verify_response_with:
        function: src.utils.common:assert_response_length
        extra_kwargs:
          expected_length: 6

  - name: List categories with title filter
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/coursegroups/{course_group_id}/courses/{course_id}/categories/?title=Case%20Study%20%F0%9F%93%9D"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      save:
        json:
          category_id: "[0].id"

  - name: List homework
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/coursegroups/{course_group_id}/courses/{course_id}/homework/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      verify_response_with:
        function: src.utils.common:assert_response_length
        extra_kwargs:
          expected_length: 17
      save:
        json:
          homework_id: "[4].id"

  - name: Get course group
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/coursegroups/{course_group_id}/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      json:
        title: "Fall Semester"
        overall_grade: "87.7934"
        trend: 0.0010061923076923659
        num_homework: 53
        num_homework_completed: 35
        num_homework_graded: 25

  - name: Get course
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/coursegroups/{course_group_id}/courses/{course_id}/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      json:
        title: "Intro to Psychology üß†"
        current_grade: "84.9700"
        trend: 0.01880931428571422
        has_weighted_grading: true
        num_homework: 17
        num_homework_completed: 10
        num_homework_graded: 6

  - name: Get category
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/coursegroups/{course_group_id}/courses/{course_id}/categories/{category_id}/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      json:
        title: "Case Study üîé"
        average_grade: "89.0000"
        grade_by_weight: "22.2500"
        trend: 0.1100000000000001
        num_homework: 3
        num_homework_graded: 2

  - name: Get homework
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/coursegroups/{course_group_id}/courses/{course_id}/homework/{homework_id}/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      json:
        title: "Quiz 2"
        current_grade: "81.25/100"
        completed: true

  - name: List material groups
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/materialgroups/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      verify_response_with:
        function: src.utils.common:assert_response_length
        extra_kwargs:
          expected_length: 3
      save:
        json:
          material_group_id: "[2].id"

  - name: List materials
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/materialgroups/{material_group_id}/materials/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      verify_response_with:
        function: src.utils.common:assert_response_length
        extra_kwargs:
          expected_length: 3
      save:
        json:
          material_id: "[2].id"

  - name: Get material group
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/materialgroups/{material_group_id}/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      json:
        title: "Textbooks"

  - name: Get material
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/materialgroups/{material_group_id}/materials/{material_id}/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      json:
        title: "Psychology, 14th Edition"
        status: 0
        condition: 0
        price: $45.00

  - name: List reminders
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/reminders/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      verify_response_with:
        function: src.utils.common:assert_response_length
        extra_kwargs:
          expected_length: 7
      save:
        json:
          reminder_id: "[0].id"

  - name: Get reminder
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/reminders/{reminder_id}/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      json:
        title: "90 minutes to complete exam"
        offset: 30
        offset_type: 0
        type: 0
        sent: false

  - name: Get grades
    request:
      url: "{tavern.env_vars.PROJECT_API_HOST}/planner/grades/"
      verify: false
      method: GET
      headers:
        Authorization: "Bearer {access_token:s}"
    response:
      status_code: 200
      json:
        course_groups:
          - title: Fall Semester
            overall_grade: 87.7934
            courses:
              - title: Creative Writing ‚úçÔ∏è
                overall_grade: 89.3269
                categories:
                  - title: Essay üìù
                    overall_grade: 88.6
                  - title: Final Portfolio üìö
                    overall_grade: -1
