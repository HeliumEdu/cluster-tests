test_name: Test frontend health

strict: False

stages:
  - name: Check frontend index returns 200
    request:
      url: "{tavern.env_vars.PROJECT_APP_HOST}"
      verify: false
      method: GET
    response:
      status_code: 200

  - name: Get frontend info
    request:
      url: "{tavern.env_vars.PROJECT_APP_HOST}/info"
      verify: false
      method: GET
    response:
      status_code: 200
      json:
        health: ok
      save:
        json:
          frontend_version: version

  - name: Check frontend vendor non-versioned asset returns 200
    request:
      url: "{tavern.env_vars.PROJECT_APP_HOST}/assets/img/logo_full_blue.png"
      verify: false
      method: GET
    response:
      status_code: 200

  - name: Check frontend vendor versioned asset returns 200
    request:
      url: "{tavern.env_vars.PROJECT_APP_HOST}/assets/{frontend_version:s}/css/font/FontAwesome.otf"
      verify: false
      method: GET
    response:
      status_code: 200

  - name: Check frontend Helium bundle returns 200
    request:
      url: "{tavern.env_vars.PROJECT_APP_HOST}/assets/{frontend_version:s}/js/base.header.bundle.min.js"
      verify: false
      method: GET
    response:
      status_code: 200

  - name: Check frontend handles not found
    request:
      url: "{tavern.env_vars.PROJECT_APP_HOST}/a-fake-page"
      verify: false
      method: GET
    response:
      status_code: 404
